{
  "openapi": "3.0.1",
  "info": {
    "title": "OpenAPI definition",
    "version": "v0"
  },
  "servers": [
    {
      "url": "http://localhost:8080",
      "description": "Generated server url"
    }
  ],
  "tags": [
    {
      "name": "App user",
      "description": "Expose app user related resources."
    },
    {
      "name": "App user recommendation",
      "description": "Expose recommendation related resources for an app user."
    },
    {
      "name": "App user questionnaire",
      "description": "Expose questionnaire related resources for an app user."
    },
    {
      "name": "App user authentication",
      "description": "Expose authentication related resources for an app user."
    }
  ],
  "paths": {
    "/api/v1/me/recommendations/status": {
      "put": {
        "tags": [
          "App user recommendation"
        ],
        "summary": "Set recommendation status.",
        "operationId": "setStatus",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateStatus"
              }
            }
          },
          "required": true
        },
        "responses": {
          "204": {
            "description": "No Content"
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/hal+json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/api/v1/me/recommendations/rating": {
      "put": {
        "tags": [
          "App user recommendation"
        ],
        "summary": "Set recommendation rating.",
        "operationId": "setRating",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateRating"
              }
            }
          },
          "required": true
        },
        "responses": {
          "204": {
            "description": "No Content"
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/hal+json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/api/v1/me/questionnaire/onboarding_answers": {
      "post": {
        "tags": [
          "App user questionnaire"
        ],
        "summary": "Set user app answers for the onboarding questionnaires.",
        "operationId": "onboardingAnswers",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/QuestionnaireAnswers"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "204": {
            "description": "No Content"
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/hal+json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/api/v1/me/questionnaire/answers": {
      "post": {
        "tags": [
          "App user questionnaire"
        ],
        "summary": "Set user app answers for a questionnaire.",
        "operationId": "answers",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/QuestionnaireAnswers"
              }
            }
          },
          "required": true
        },
        "responses": {
          "204": {
            "description": "No Content"
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/hal+json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/api/v1/app_users/logout": {
      "post": {
        "tags": [
          "App user authentication"
        ],
        "summary": "Logout an app user supplying PAT's id and the associated user client id.",
        "operationId": "logout",
        "parameters": [
          {
            "name": "Client-User-Id",
            "in": "header",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PATReferenceDelete"
              }
            }
          },
          "required": true
        },
        "responses": {
          "204": {
            "description": "No Content"
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/hal+json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/api/v1/app_users/login": {
      "post": {
        "tags": [
          "App user authentication"
        ],
        "summary": "Authenticate an app user supplying an app PAT and the associated user client id.\n        If the user client id does not exist in the app, a new user will be registered on the fly.\n        This endpoint should be used also after the PAT expires to retrieve a new one.\n        ",
        "operationId": "login",
        "parameters": [
          {
            "name": "Client-User-Id",
            "in": "header",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/hal+json": {
                "schema": {
                  "$ref": "#/components/schemas/ZitadelPAT"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/hal+json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/api/v1/me": {
      "get": {
        "tags": [
          "App user"
        ],
        "summary": "Return app user.",
        "operationId": "get",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/hal+json": {
                "schema": {
                  "$ref": "#/components/schemas/AppUser"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/hal+json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/api/v1/me/recommendations/tailored/topics/{topicId}": {
      "get": {
        "tags": [
          "App user recommendation"
        ],
        "summary": "A list of tailored recommendations filtered by topic.",
        "operationId": "getTailoredRecommendationsByTopic",
        "parameters": [
          {
            "name": "topicId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/hal+json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AppUserRecommendation"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/hal+json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/api/v1/me/recommendations/starting": {
      "get": {
        "tags": [
          "App user recommendation"
        ],
        "summary": "A list of starting recommendations.",
        "operationId": "getStartingRecommendations",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/hal+json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AppUserRecommendation"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/hal+json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/api/v1/me/recommendations/preferred": {
      "get": {
        "tags": [
          "App user recommendation"
        ],
        "summary": "A list of recommendations which are improved by the preferences.",
        "operationId": "getUserPreferredRecommendations",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/hal+json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AppUserRecommendation"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/hal+json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/api/v1/me/recommendations/newest": {
      "get": {
        "tags": [
          "App user recommendation"
        ],
        "summary": "A list of newest content.",
        "operationId": "getNewestContent",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/hal+json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AppUserRecommendation"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/hal+json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/api/v1/me/recommendations/most_popular": {
      "get": {
        "tags": [
          "App user recommendation"
        ],
        "summary": "A list of most popular content.",
        "operationId": "getMostPopularContent",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/hal+json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AppUserRecommendation"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/hal+json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/api/v1/me/recommendations/feed": {
      "get": {
        "tags": [
          "App user recommendation"
        ],
        "summary": "Recommendations feed.",
        "operationId": "getFeed",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/hal+json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/FeedSection"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/hal+json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/api/v1/me/recommendations/explore/topics/{topicId}": {
      "get": {
        "tags": [
          "App user recommendation"
        ],
        "summary": "A list of content filtered by topic.",
        "operationId": "exploreContentByTopic",
        "parameters": [
          {
            "name": "topicId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/hal+json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AppUserRecommendation"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/hal+json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/api/v1/me/recommendations/articles/{recommendationId}": {
      "get": {
        "tags": [
          "App user recommendation"
        ],
        "summary": "Get article.",
        "operationId": "getArticle",
        "parameters": [
          {
            "name": "recommendationId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/hal+json": {
                "schema": {
                  "$ref": "#/components/schemas/AppUserArticle"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/hal+json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/api/v1/me/questionnaire/topics/{topicId}": {
      "get": {
        "tags": [
          "App user questionnaire"
        ],
        "summary": "Return the associated questionnaire for a given topic.",
        "operationId": "getQuestionnaireByTopic",
        "parameters": [
          {
            "name": "topicId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/hal+json": {
                "schema": {
                  "$ref": "#/components/schemas/Questionnaire"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/hal+json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/api/v1/me/questionnaire/onboarding_questionnaires": {
      "get": {
        "tags": [
          "App user questionnaire"
        ],
        "summary": "Return the onboarding questionnaires.",
        "operationId": "onboarding",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/hal+json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Questionnaire"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/hal+json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    }
  },
  "components": {
    "schemas": {
      "ContentId": {
        "required": [
          "catalogId",
          "itemId"
        ],
        "type": "object",
        "properties": {
          "itemId": {
            "type": "string"
          },
          "catalogId": {
            "type": "string"
          }
        }
      },
      "UpdateStatus": {
        "required": [
          "categoriesIds",
          "contentId",
          "contentType",
          "status"
        ],
        "type": "object",
        "properties": {
          "contentId": {
            "$ref": "#/components/schemas/ContentId"
          },
          "contentType": {
            "type": "string",
            "enum": [
              "articles"
            ]
          },
          "status": {
            "type": "string",
            "enum": [
              "no_interaction",
              "viewed"
            ]
          },
          "categoriesIds": {
            "type": "array",
            "items": {
              "type": "integer",
              "format": "int32"
            }
          }
        }
      },
      "ApiError": {
        "required": [
          "errorCode",
          "message",
          "traceId"
        ],
        "type": "object",
        "properties": {
          "errorCode": {
            "type": "string",
            "enum": [
              "UNKNOWN",
              "RESOURCE_NOT_FOUND",
              "UNAUTHORIZED",
              "APP_DISABLED",
              "BAD_REQUEST",
              "CONFLICT"
            ]
          },
          "message": {
            "type": "string"
          },
          "traceId": {
            "type": "string"
          }
        }
      },
      "UpdateRating": {
        "required": [
          "categoriesIds",
          "contentId",
          "contentType",
          "rating"
        ],
        "type": "object",
        "properties": {
          "contentId": {
            "$ref": "#/components/schemas/ContentId"
          },
          "contentType": {
            "type": "string",
            "enum": [
              "articles"
            ]
          },
          "rating": {
            "type": "string",
            "enum": [
              "like",
              "dislike",
              "not_rated"
            ]
          },
          "categoriesIds": {
            "type": "array",
            "items": {
              "type": "integer",
              "format": "int32"
            }
          }
        }
      },
      "CreateQuestionnaireAnswer": {
        "required": [
          "questionId",
          "type"
        ],
        "type": "object",
        "properties": {
          "multichoice": {
            "type": "array",
            "items": {
              "type": "integer",
              "format": "int32"
            }
          },
          "numeric": {
            "type": "number",
            "format": "double"
          },
          "questionId": {
            "type": "string"
          },
          "type": {
            "type": "string",
            "enum": [
              "multichoice",
              "numeric"
            ]
          }
        }
      },
      "QuestionnaireAnswers": {
        "required": [
          "answers",
          "categoriesIds",
          "id"
        ],
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "categoriesIds": {
            "type": "array",
            "items": {
              "type": "integer",
              "format": "int32"
            }
          },
          "answers": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CreateQuestionnaireAnswer"
            }
          }
        }
      },
      "PATReferenceDelete": {
        "required": [
          "tokenId"
        ],
        "type": "object",
        "properties": {
          "tokenId": {
            "type": "string",
            "description": "PAT's id"
          }
        }
      },
      "ZitadelPAT": {
        "required": [
          "accessToken",
          "creationDate",
          "tokenId"
        ],
        "type": "object",
        "properties": {
          "tokenId": {
            "type": "string"
          },
          "accessToken": {
            "type": "string"
          },
          "creationDate": {
            "type": "string",
            "format": "date-time"
          },
          "expirationDate": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "AppUser": {
        "required": [
          "id"
        ],
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          }
        }
      },
      "AppUserRecommendation": {
        "required": [
          "categoriesIds",
          "headline",
          "id",
          "rating",
          "status",
          "type"
        ],
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/components/schemas/ContentId"
          },
          "type": {
            "type": "string",
            "enum": [
              "articles"
            ]
          },
          "rating": {
            "type": "string",
            "enum": [
              "like",
              "dislike",
              "not_rated"
            ]
          },
          "status": {
            "type": "string",
            "enum": [
              "no_interaction",
              "viewed"
            ]
          },
          "headline": {
            "type": "string"
          },
          "lead": {
            "type": "string"
          },
          "imageUrl": {
            "type": "string"
          },
          "categoriesIds": {
            "type": "array",
            "items": {
              "type": "integer",
              "format": "int32"
            }
          }
        }
      },
      "FeedSection": {
        "required": [
          "recommendations",
          "type"
        ],
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "STARTING_RECOMMENDATION",
              "TAILORED_RECOMMENDATION",
              "TAILORED_NUTRITION_RECOMMENDATION",
              "MOST_POPULAR"
            ]
          },
          "recommendations": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AppUserRecommendation"
            }
          }
        }
      },
      "AppUserArticle": {
        "required": [
          "headline",
          "id",
          "rating",
          "status"
        ],
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "rating": {
            "type": "string",
            "enum": [
              "like",
              "dislike",
              "not_rated"
            ]
          },
          "status": {
            "type": "string",
            "enum": [
              "no_interaction",
              "viewed"
            ]
          },
          "headline": {
            "type": "string"
          },
          "lead": {
            "type": "string"
          },
          "imageUrl": {
            "type": "string"
          },
          "articleBodyHtml": {
            "type": "string"
          }
        }
      },
      "MultiChoiceAnswerOption": {
        "required": [
          "id",
          "text"
        ],
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "format": "int32"
          },
          "text": {
            "type": "string"
          }
        }
      },
      "MultiChoiceQuestion": {
        "required": [
          "maxOptions",
          "minOptions",
          "options"
        ],
        "type": "object",
        "properties": {
          "maxOptions": {
            "type": "integer",
            "format": "int32"
          },
          "minOptions": {
            "type": "integer",
            "format": "int32"
          },
          "options": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/MultiChoiceAnswerOption"
            }
          }
        }
      },
      "NumericQuestion": {
        "required": [
          "format",
          "maxValue",
          "minValue"
        ],
        "type": "object",
        "properties": {
          "maxValue": {
            "type": "integer",
            "format": "int32"
          },
          "minValue": {
            "type": "integer",
            "format": "int32"
          },
          "format": {
            "type": "string",
            "enum": [
              "HUMAN_HEIGHT",
              "HUMAN_WEIGHT",
              "INTEGER",
              "DECIMAL"
            ]
          }
        }
      },
      "Question": {
        "required": [
          "id",
          "index",
          "text",
          "type"
        ],
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "index": {
            "type": "integer",
            "format": "int32"
          },
          "text": {
            "type": "string"
          },
          "type": {
            "type": "string",
            "enum": [
              "multichoice",
              "numeric"
            ]
          },
          "multiChoice": {
            "$ref": "#/components/schemas/MultiChoiceQuestion"
          },
          "numeric": {
            "$ref": "#/components/schemas/NumericQuestion"
          }
        }
      },
      "Questionnaire": {
        "required": [
          "categoriesIds",
          "id",
          "questions"
        ],
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "categoriesIds": {
            "type": "array",
            "items": {
              "type": "integer",
              "format": "int32"
            }
          },
          "questions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Question"
            }
          }
        }
      }
    },
    "securitySchemes": {
      "oauth2": {
        "type": "oauth2",
        "flows": {
          "authorizationCode": {
            "authorizationUrl": "to_be_defined",
            "tokenUrl": "to_be_defined",
            "scopes": {}
          }
        }
      },
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer"
      }
    }
  }
}